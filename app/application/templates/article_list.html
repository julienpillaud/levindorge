{% extends "base.html" %}
{% block content %}

    <div class="container-fluid padding-navbar">
        <table class="table table-striped table-bordered table-hover table-sm sortable" id="articlesList">
            <thead class="sticky" style="--sticky-top: 53px">
            <tr>
                <th class="text-center align-middle bg-light-purple" role="button">#</th>

                <!-- NAME 1 -->
                {% if list_category in ["beer", "keg", "mini_keg"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">Brasserie</th>
                {% elif list_category in ["cider"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">Cidrerie</th>
                {% elif list_category in ["rhum", "whisky", "arranged", "spirit"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">Distillerie</th>
                {% elif list_category in ["wine", "fortified_wine", "sparkling_wine", "bib"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">Appellation</th>
                {% else %}
                    <th class="text-center align-middle bg-light-purple" role="button">Désignation</th>
                {% endif %}

                <!-- NAME 2 -->
                {% if list_category not in ["box", "misc", "food"] %}
                    {% if list_category in ["beer", "keg", "mini_keg"] %}
                        <th class="text-center align-middle bg-light-purple" role="button">Bière</th>
                    {% elif list_category in ["cider"] %}
                        <th class="text-center align-middle bg-light-purple" role="button">Cidre</th>
                    {% elif list_category in ["rhum", "whisky", "arranged", "spirit"] %}
                        <th class="text-center align-middle bg-light-purple" role="button">Spiritueux</th>
                    {% elif list_category in ["wine", "fortified_wine", "sparkling_wine", "bib"] %}
                        <th class="text-center align-middle bg-light-purple" role="button">Produit</th>
                    {% endif %}
                {% endif %}

                <!-- REGION -->
                {% if list_category not in ["box", "misc", "food"] %}
                    {% if list_category in ["wine", "fortified_wine", "sparkling_wine", "bib"] %}
                        <th class="text-center align-middle bg-light-purple" role="button">Région</th>
                    {% else %}
                        <th class="text-center align-middle bg-light-purple" role="button">Pays</th>
                    {% endif %}
                {% endif %}

                <!-- COLOR / TASTE -->
                {% if list_category not in ["arranged", "box", "misc", "food"] %}
                    {% if list_category in ["rhum", "whisky", "spirit"] %}
                        <th class="text-center align-middle bg-light-purple" role="button">Saveur</th>
                    {% else %}
                        <th class="text-center align-middle bg-light-purple" role="button">Couleur</th>
                    {% endif %}
                {% endif %}

                <!-- VOLUME -->
                {% if list_category not in ["box", "misc", "food"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">Vol</th>
                {% endif %}

                <!-- ALCOHOL_BY_VOLUME -->
                {% if list_category not in ["wine", "fortified_wine", "sparkling_wine", "bib", "box", "misc", "food"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">Deg</th>
                {% endif %}

                <!-- PRICE -->
                <th class="text-center align-middle bg-light-purple text-nowrap" role="button">HT DI</th>
                {% if list_category not in ["misc", "food"] %}
                    <th class="text-center align-middle bg-light-purple text-nowrap" role="button">PVC</th>
                {% endif %}
                <th class="text-center align-middle bg-light-purple text-nowrap" role="button">TTC</th>
                <th class="text-center align-middle bg-light-purple text-nowrap" role="button">M (€)</th>
                <th class="text-center align-middle bg-light-purple text-nowrap" role="button">Tm (%)</th>

                <!-- STOCK -->
                <th class="text-center align-middle bg-light-purple" role="button">Stock</th>

                <!-- DISTRIBUTOR -->
                <th class="text-center align-middle bg-light-purple" role="button">Fournisseur</th>

                <!-- PACKAGING / DEPOSIT -->
                {% if list_category in ["beer"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">Cond</th>
                {% endif %}
                {% if list_category in ["beer"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">C.Btle</th>
                {% endif %}
                {% if list_category in ["keg", "mini_keg"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">Cons</th>
                {% endif %}
                {% if list_category in ["beer"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">C.Cai</th>
                {% endif %}
                <!-- TYPE -->
                {% if list_category in ["spirit", "fortified_wine",  "misc"] %}
                    <th class="text-center align-middle bg-light-purple" role="button">Type</th>
                {% endif %}

                <!-- BUTTON -->
                {% if current_user.role in ["admin", "superuser"] %}
                    <th class="bg-light-purple not-sortable"></th>
                {% endif %}
                <th class="bg-light-purple not-sortable"></th>

            </tr>
            </thead>
            <tbody>
            {% for article in articles %}
                <tr>
                    <td class="text-center font-weight-bold">{{ loop.index }}</td>

                    <!-- NAME 1 -->
                    <td class="">{{ article.name.name1 }}</td>

                    <!-- NAME 2 -->
                    {% if list_category not in ["box", "misc", "food"] %}
                        <td class="">{{ article.name.name2 }}</td>
                    {% endif %}

                    <!-- REGION -->
                    {% if list_category not in ["box", "misc", "food"] %}
                        <td class="text-center">{{ article.region }}</td>
                    {% endif %}

                    <!-- COLOR / TASTE -->
                    {% if list_category not in ["arranged", "box", "misc", "food"] %}
                        {% if list_category in ["rhum", "whisky", "spirit"] %}
                            <td class="text-center">{{ article.taste }}</td>
                        {% else %}
                            <td class="text-center">{{ article.color }}</td>
                        {% endif %}
                    {% endif %}

                    <!-- VOLUME -->
                    {% if list_category not in ["box", "misc", "food"] %}
                        <td class="text-center">{{ article.volume.value | strip_zeros }}</td>
                    {% endif %}

                    <!-- ALCOHOL_BY_VOLUME -->
                    {% if list_category not in ["wine", "fortified_wine", "sparkling_wine", "bib", "box", "misc", "food"] %}
                        <td class="text-center">{{ article.alcohol_by_volume | strip_zeros }}</td>
                    {% endif %}

                    <!-- PRICE -->
                    <td class="text-center">{{ article.taxfree_price | strip_zeros }}</td>
                    {% if list_category not in ["misc", "food"] %}
                        <td class="text-center recommended_price">{{ article.recommended_price | strip_zeros }}</td>
                    {% endif %}
                    <td class="text-center sell_price">
                        {{ article.shops[current_shop.username]["sell_price"] | strip_zeros }}
                    </td>
                    <td class="text-center">{{ article.margin.margin | strip_zeros }}</td>
                    <td class="text-center">{{ article.margin.markup | strip_zeros }}</td>

                    <!-- STOCK -->
                    <td class="text-center stock_quantity">
                        {{ article.shops[current_shop.username]["stock_quantity"] if article.shops[current_shop.username]["stock_quantity"] }}
                    </td>

                    <!-- DISTRIBUTOR -->
                    <td class="text-center">{{ article.distributor }}</td>

                    <!-- PACKAGING / DEPOSIT -->
                    {% if list_category in ["beer"] %}
                        <td class="text-center">{{ article.packaging if article.packaging }}</td>
                    {% endif %}
                    {% if list_category in ["beer", "keg", "mini_keg"] %}
                        <td class="text-center">{{ article.deposit.unit | strip_zeros  if article.deposit.unit }}</td>
                    {% endif %}
                    {% if list_category in ["beer"] %}
                        <td class="text-center">{{ article.deposit.case | strip_zeros  if article.deposit.case }}</td>
                    {% endif %}

                    <!-- TYPE -->
                    {% if list_category in ["spirit", "fortified_wine", "misc"] %}
                        <td class="text-center">{{ article.type }}</td>
                    {% endif %}

                    <!-- BUTTON -->
                    <td class="text-center" style="width: 20px">
                        <a href="{{ url_for('update_article_view', article_id=article.id) }}">
                            <i class="bi bi-pencil-square text-warning"></i>
                        </a>
                    </td>
                    {% if current_user.role in ["admin", "superuser"] %}
                        <td class="text-center" style="width: 20px">
                            <a href="{{ url_for('delete_article', article_id=article.id) }}">
                                <i class="bi bi-x-square text-danger"></i>
                            </a>
                        </td>
                    {% endif %}

                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

{% endblock %}
